-- =============================================-- Author: <ChengXianYu>-- Create date: <2013-08-11>-- Description: -- =============================================IF (EXISTS (SELECT * FROM SYS.OBJECTS WHERE NAME = 'P_STATIC_CASH_STATEMENT'))    DROP PROC P_STATIC_CASH_STATEMENTGOCREATE PROCEDURE P_STATIC_CASH_STATEMENTAS  BEGIN    DELETE FROM T_CASH_STATEMENT;	--合同回款	INSERT INTO T_CASH_STATEMENT(STAT_DATE, SETTLE_CONTRACT) 	SELECT RECEIVE_DATE, RECEIVE_AMOUNT FROM T_AMOUNT_RECEIVE WHERE RELATE_MODULE = 'CONTRACT_LEASE' AND APPLYFOR_STATE = '3';	--借款返还	INSERT INTO T_CASH_STATEMENT(STAT_DATE, BACK_AMOUNT) 	SELECT BACK_DATE, BACK_AMOUNT FROM T_MONEY_BACK WHERE APPLYFOR_STATE = '3';	--采购退款	INSERT INTO T_CASH_STATEMENT(STAT_DATE, PURCHASE_AMOUNT) 	SELECT RECEIVE_DATE, RECEIVE_AMOUNT FROM T_AMOUNT_RECEIVE WHERE RELATE_MODULE = 'PURCHASE' AND APPLYFOR_STATE = '3';	--保险理赔	INSERT INTO T_CASH_STATEMENT(STAT_DATE, CLAIM_AMOUNT) 	SELECT RECEIVE_DATE, RECEIVE_AMOUNT FROM T_AMOUNT_RECEIVE WHERE RELATE_MODULE = 'INSURE_EQUIP' AND APPLYFOR_STATE = '3';	--采购付款	INSERT INTO T_CASH_STATEMENT(STAT_DATE, PURCHASE_PAY_AMOUNT) 	SELECT PAYMENT_DATE, PAYMENT_AMOUNT FROM T_AMOUNT_PAYMENT WHERE RELATE_MODULE = 'PURCHASE' AND APPLYFOR_STATE = '3';	--费用借款	INSERT INTO T_CASH_STATEMENT(STAT_DATE, LEND_AMOUNT) 	SELECT LEND_DATE, LEND_AMOUNT FROM T_MONEY_LEND WHERE APPLYFOR_STATE = '3';	--费用报销	INSERT INTO T_CASH_STATEMENT(STAT_DATE, REIMBURSE_AMOUNT) 	SELECT REIMBURSE_DATE, REIMBURSE_AMOUNT FROM T_REIMBURSE WHERE APPLYFOR_STATE = '3';	--工资支出	INSERT INTO T_CASH_STATEMENT(STAT_DATE, SALARY_AMOUNT) 	SELECT SALARY_DATE, SUM(SALARY_AMOUNT) FROM T_SALARY WHERE APPLYFOR_STATE = '3' AND SALARY_AMOUNT > 0 GROUP BY SALARY_DATE;	--设备按揭	INSERT INTO T_CASH_STATEMENT(STAT_DATE, EQUIP_MORTGAGE) 	SELECT PAYMENT_DATE, PAYMENT_AMOUNT FROM T_AMOUNT_PAYMENT WHERE RELATE_MODULE = 'EQUIPMENT' AND APPLYFOR_STATE = '3';	--保险费	INSERT INTO T_CASH_STATEMENT(STAT_DATE, INSURE_AMOUNT) 	SELECT PAYMENT_DATE, PAYMENT_AMOUNT FROM T_AMOUNT_PAYMENT WHERE RELATE_MODULE = 'INSURE_EQUIP' AND APPLYFOR_STATE = '3';	--检测费	INSERT INTO T_CASH_STATEMENT(STAT_DATE, EQUIP_DETECT) 	SELECT PAYMENT_DATE, PAYMENT_AMOUNT FROM T_AMOUNT_PAYMENT WHERE RELATE_MODULE = 'EQUIP_DETECT' AND APPLYFOR_STATE = '3';	--物流运输费	INSERT INTO T_CASH_STATEMENT(STAT_DATE, LOGISTICS_TRANSPORT) 	SELECT PAYMENT_DATE, PAYMENT_AMOUNT FROM T_AMOUNT_PAYMENT WHERE RELATE_MODULE = 'LOGISTICS_TRANSPORT' AND APPLYFOR_STATE = '3';	--班组结算费	INSERT INTO T_CASH_STATEMENT(STAT_DATE, TEAMS_ACCOUNT) 	SELECT PAYMENT_DATE, PAYMENT_AMOUNT FROM T_AMOUNT_PAYMENT WHERE RELATE_MODULE = 'TEAMS_ACCOUNT' AND APPLYFOR_STATE = '3';	--转租结算费	INSERT INTO T_CASH_STATEMENT(STAT_DATE, RENT_CONTRACT) 	SELECT PAYMENT_DATE, PAYMENT_AMOUNT FROM T_AMOUNT_PAYMENT WHERE RELATE_MODULE = 'RENT_CONTRACT' AND APPLYFOR_STATE = '3';	--税金	INSERT INTO T_CASH_STATEMENT(STAT_DATE, TAX_AMOUNT) 			SELECT PROVIDED_DATE, SUM(TAX_AMOUNT) TAX_AMOUNT FROM T_SETTLE_CONTRACT WHERE EFFECTIVE = '1' AND TAX_AMOUNT > 0 GROUP BY PROVIDED_DATE;  END;