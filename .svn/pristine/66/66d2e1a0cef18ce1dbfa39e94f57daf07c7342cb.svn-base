<?xml version="1.0" encoding="UTF-8"?>
<jasperReport xmlns="http://jasperreports.sourceforge.net/jasperreports" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://jasperreports.sourceforge.net/jasperreports http://jasperreports.sourceforge.net/xsd/jasperreport.xsd" name="Equip_Output_Value_Detail" language="groovy" pageWidth="5000" pageHeight="1200" orientation="Landscape" whenNoDataType="AllSectionsNoDetail" columnWidth="4960" leftMargin="20" rightMargin="20" topMargin="20" bottomMargin="20" uuid="7d4f5689-c309-4c29-8263-f8509c733162">
	<property name="ireport.zoom" value="1.0"/>
	<property name="ireport.x" value="0"/>
	<property name="ireport.y" value="0"/>
	<style name="Crosstab Data Text" hAlign="Center"/>
	<parameter name="startDate" class="java.lang.String">
		<defaultValueExpression><![CDATA[]]></defaultValueExpression>
	</parameter>
	<parameter name="endDate" class="java.lang.String">
		<defaultValueExpression><![CDATA[]]></defaultValueExpression>
	</parameter>
	<parameter name="projectIds" class="java.lang.String">
		<defaultValueExpression><![CDATA[]]></defaultValueExpression>
	</parameter>
	<parameter name="paEnt" class="java.lang.String">
		<defaultValueExpression><![CDATA[]]></defaultValueExpression>
	</parameter>
	<parameter name="depId" class="java.lang.String">
		<defaultValueExpression><![CDATA[]]></defaultValueExpression>
	</parameter>
	<queryString>
		<![CDATA[DECLARE @startDate VARCHAR(10)
DECLARE @endDate VARCHAR(10)
DECLARE @projectIds VARCHAR(3000)
DECLARE @paEnt BIGINT
DECLARE @depId BIGINT
SET @startDate =$P{startDate}
SET @endDate = $P{endDate}
SET @projectIds = $P{projectIds}
SET @paEnt = $P{paEnt}
SET @depId = $P{depId}
;WITH QUERY AS (  --过滤出结算符合条件的结算单
	SELECT
	SETTLE_ID,
	SC.CONTRACT_ID,
	RIGHT(LEFT(START_SETTLE_DATE,7),2)+'月' AS 'START_SETTLE_DATE',
	CL.PA_ENT_NAME,
	CL.PROJECT_NAME,
	CL.CONSTRACT_NO,
	(SELECT MATERIAL_PRACTI_NAME FROM T_PROJECT P WHERE P.PROJECT_ID=CL.PROJECT_ID) AS 'PROJECT_MANAGER',
	CL.COMPETENT_DEPARTMET AS 'DEP_NAME'
	FROM T_SETTLE_CONTRACT SC
	LEFT JOIN T_CONTRACT_LEASE CL ON SC.CONTRACT_ID=CL.CONTRACT_ID
	WHERE SC.DEL_FLAG='1' AND SC.EFFECTIVE='1' AND CL.DEL_FLAG='1'
		AND (CL.PA_ENT = @paEnt OR @paEnt IS NULL OR @paEnt='')
		AND (CL.COMPETENT_DEPARTMET_ID = @depId OR @depId IS NULL OR @depId='')
		AND (@projectIds IS NULL OR @projectIds='' OR CHARINDEX(','+CONVERT(VARCHAR(12),CL.PROJECT_ID)+',', ','+@projectIds+',')>0)
		AND START_SETTLE_DATE>= @startDate AND START_SETTLE_DATE<= @endDate
), QUERY1 AS (	--设备的各种费用拼接
	SELECT 'A月租'AS 'TYPE', SETTLE_ID, EQUIP_ID, SUMMARY FROM T_SETTLE_EQUIP_BRIEF SEB WHERE EXISTS(SELECT * FROM QUERY SC WHERE SC.SETTLE_ID = SEB.SETTLE_ID)
	UNION ALL
	SELECT 'B加节费'AS 'TYPE', SETTLE_ID, EQUIP_ID, SUMMARY FROM T_SETTLE_COMPON_BRIEF SCB WHERE EXISTS(SELECT * FROM QUERY SC WHERE SC.SETTLE_ID = SCB.SETTLE_ID)
	UNION ALL
	SELECT 'C进场费'AS 'TYPE', SETTLE_ID, EQUIP_ID, SUMMARY FROM T_SETTLE_ITEM_BRIEF SIB WHERE EXISTS(SELECT * FROM QUERY SC WHERE SC.SETTLE_ID = SIB.SETTLE_ID)
	UNION ALL
	SELECT 'D司机工资'AS 'TYPE', SETTLE_ID, EQUIP_ID, COST_TOTAL AS 'SUMMARY' FROM T_OPERATOR_SALARY_STATEMENT OSS WHERE EXISTS(SELECT * FROM QUERY SC WHERE SC.SETTLE_ID = OSS.SETTLE_ID)
	UNION ALL
	SELECT 'E安全监控'AS 'TYPE', SETTLE_ID, EQUIP_ID, SUMMARY FROM T_SAFETY_MONITOR_SETTLE_STATEMENT MSS WHERE EXISTS(SELECT * FROM QUERY SC WHERE SC.SETTLE_ID = MSS.SETTLE_ID)
	UNION ALL
	SELECT 'F其他费用'AS 'TYPE', SETTLE_ID, EQUIP_ID, AMOUNT AS 'SUMMARY' FROM T_OTHER_EXPENSE_STATEMENT OES WHERE EXISTS(SELECT * FROM QUERY SC WHERE SC.SETTLE_ID = OES.SETTLE_ID)
), QUERY2 AS (  --查询其他先关字段
	SELECT
	Q1.*,
	Q.START_SETTLE_DATE,  --月份字段
	Q.CONTRACT_ID,
	Q.PA_ENT_NAME,		--承租单位
	Q.PROJECT_NAME,
	Q.DEP_NAME,
	Q.CONSTRACT_NO,
	Q.PROJECT_MANAGER,		--项目经理
	E.EQUIP_SERIAL,			--设备自编号
	ES.VALUE AS 'EQUIP_SPECIFIC'		--规格型号
	FROM QUERY1 Q1
	LEFT JOIN QUERY Q ON Q.SETTLE_ID=Q1.SETTLE_ID
	LEFT JOIN T_EQUIPMENT E ON E.EQUIP_ID=Q1.EQUIP_ID
	LEFT JOIN BM_EQUIP_SPECIFIC ES ON ES.CODE=E.EQUIP_SPECIFIC
) ,QUERY3 AS (		--查询关联的安装日期，启用日期，停用日期
	SELECT
	T.*,
	CONVERT(VARCHAR(10),EI.STARTIN_DATE,23) AS 'STARTIN_DATE',
	EA.ACTIVATE_DATE,
	CONVERT(VARCHAR(10),EB.BLOCKUP_DATE,23) AS 'BLOCKUP_DATE'
	FROM (
		SELECT MAX(FLOW_ID)AS 'FLOW_ID',EF.EQUIP_ID,EF.CONTRACT_ID
		FROM T_EQUIPMENT_FLOW EF
		WHERE EXISTS(SELECT * FROM QUERY2 Q2 WHERE EF.CONTRACT_ID=Q2.CONTRACT_ID AND EF.EQUIP_ID=Q2.EQUIP_ID)
		GROUP BY EF.EQUIP_ID,EF.CONTRACT_ID
	) T
	LEFT JOIN (SELECT FLOW_ID,STARTIN_DATE FROM T_EQUIPMENT_INSTALL WHERE DEL_FLAG='1' AND APPLYFOR_STATE='3' ) EI ON T.FLOW_ID=EI.FLOW_ID
	LEFT JOIN (SELECT FLOW_ID,ACTIVATE_DATE FROM T_EQUIPMENT_ACTIVATE WHERE DEL_FLAG='1' AND EFFECTIVE='1') EA ON T.FLOW_ID=EA.FLOW_ID
	LEFT JOIN (SELECT FLOW_ID,BLOCKUP_DATE FROM T_EQUIPMENT_BLOCKUP WHERE DEL_FLAG='1' AND EFFECTIVE='1') EB ON T.FLOW_ID = EB.FLOW_ID
)
SELECT
--CASE WHEN PATINDEX('广西建工集团%',Q2.PA_ENT_NAME)<>0 THEN '1集团内' ELSE '2集团外' END AS 'GROUP_COMPANY',
CASE WHEN PATINDEX('广西建工集团%',Q2.PA_ENT_NAME)<>0 THEN '1'+RIGHT(LEFT(Q2.PA_ENT_NAME,10),4) ELSE '2'+Q2.PA_ENT_NAME END 'GROUP_COMPANY',
Q2.* ,
Q3.STARTIN_DATE,
Q3.ACTIVATE_DATE,
Q3.BLOCKUP_DATE
FROM QUERY2 Q2
LEFT JOIN QUERY3 Q3 ON Q2.CONTRACT_ID=Q3.CONTRACT_ID AND  Q2.EQUIP_ID = Q3.EQUIP_ID]]>
	</queryString>
	<field name="GROUP_COMPANY" class="java.lang.String"/>
	<field name="TYPE" class="java.lang.String"/>
	<field name="SETTLE_ID" class="java.lang.Long"/>
	<field name="EQUIP_ID" class="java.lang.Long"/>
	<field name="SUMMARY" class="java.math.BigDecimal"/>
	<field name="START_SETTLE_DATE" class="java.lang.String"/>
	<field name="CONTRACT_ID" class="java.lang.Long"/>
	<field name="PA_ENT_NAME" class="java.lang.String"/>
	<field name="PROJECT_NAME" class="java.lang.String"/>
	<field name="DEP_NAME" class="java.lang.String"/>
	<field name="CONSTRACT_NO" class="java.lang.String"/>
	<field name="PROJECT_MANAGER" class="java.lang.String"/>
	<field name="EQUIP_SERIAL" class="java.lang.String"/>
	<field name="EQUIP_SPECIFIC" class="java.lang.String"/>
	<field name="STARTIN_DATE" class="java.lang.String"/>
	<field name="ACTIVATE_DATE" class="java.lang.String"/>
	<field name="BLOCKUP_DATE" class="java.lang.String"/>
	<title>
		<band height="79" splitType="Stretch">
			<textField>
				<reportElement x="0" y="0" width="1368" height="79" uuid="6cc17ebf-7c7b-4936-96e1-b10431931b8e"/>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font size="20"/>
				</textElement>
				<textFieldExpression><![CDATA["广西大都机械设备租赁有限责任公司"+$P{startDate}.substring(0,4)+"年"+$P{startDate}.substring(5,7)+"月-"+$P{endDate}.substring(0,4)+"年"+$P{endDate}.substring(5,7)+"月"]]></textFieldExpression>
			</textField>
		</band>
	</title>
	<summary>
		<band height="62" splitType="Stretch">
			<crosstab>
				<reportElement x="0" y="0" width="4000" height="62" uuid="342c1f4e-31af-4536-8e6b-ec10ce538801"/>
				<crosstabHeaderCell>
					<cellContents backcolor="#99CCFF" mode="Opaque">
						<staticText>
							<reportElement style="Crosstab Data Text" x="1" y="0" width="70" height="60" uuid="b70ecf73-3189-4021-aa5a-ae1f7c7f519f"/>
							<box>
								<pen lineWidth="0.5"/>
								<topPen lineWidth="0.5"/>
								<leftPen lineWidth="0.5"/>
								<bottomPen lineWidth="0.5"/>
								<rightPen lineWidth="0.5"/>
							</box>
							<textElement verticalAlignment="Middle">
								<font fontName="宋体" size="12"/>
							</textElement>
							<text><![CDATA[公司]]></text>
						</staticText>
						<staticText>
							<reportElement style="Crosstab Data Text" x="71" y="0" width="177" height="60" uuid="25d004a6-d702-454d-8612-6db8772461d8"/>
							<box>
								<pen lineWidth="0.5"/>
								<topPen lineWidth="0.5"/>
								<leftPen lineWidth="0.5"/>
								<bottomPen lineWidth="0.5"/>
								<rightPen lineWidth="0.5"/>
							</box>
							<textElement verticalAlignment="Middle">
								<font fontName="宋体" size="12"/>
							</textElement>
							<text><![CDATA[承租单位]]></text>
						</staticText>
						<staticText>
							<reportElement style="Crosstab Data Text" x="248" y="0" width="195" height="60" uuid="70e274e3-6630-41a9-bb11-cd954cb3d88a"/>
							<box>
								<pen lineWidth="0.5"/>
								<topPen lineWidth="0.5"/>
								<leftPen lineWidth="0.5"/>
								<bottomPen lineWidth="0.5"/>
								<rightPen lineWidth="0.5"/>
							</box>
							<textElement verticalAlignment="Middle">
								<font fontName="宋体" size="12"/>
							</textElement>
							<text><![CDATA[项目名称]]></text>
						</staticText>
						<staticText>
							<reportElement style="Crosstab Data Text" x="443" y="0" width="100" height="60" uuid="3b76aeb6-051c-4783-a52b-1c341bea8962"/>
							<box>
								<pen lineWidth="0.5"/>
								<topPen lineWidth="0.5"/>
								<leftPen lineWidth="0.5"/>
								<bottomPen lineWidth="0.5"/>
								<rightPen lineWidth="0.5"/>
							</box>
							<textElement verticalAlignment="Middle">
								<font fontName="宋体" size="12"/>
							</textElement>
							<text><![CDATA[所属部门]]></text>
						</staticText>
						<staticText>
							<reportElement style="Crosstab Data Text" x="543" y="0" width="100" height="60" uuid="c56365fe-18f0-4e2e-b1fe-946fa4ea9021"/>
							<box>
								<pen lineWidth="0.5"/>
								<topPen lineWidth="0.5"/>
								<leftPen lineWidth="0.5"/>
								<bottomPen lineWidth="0.5"/>
								<rightPen lineWidth="0.5"/>
							</box>
							<textElement verticalAlignment="Middle">
								<font fontName="宋体" size="12"/>
							</textElement>
							<text><![CDATA[合同编号]]></text>
						</staticText>
						<staticText>
							<reportElement style="Crosstab Data Text" x="643" y="0" width="100" height="60" uuid="bebaa9a9-6db3-4fe2-a0d5-2e6cbc079398"/>
							<box>
								<pen lineWidth="0.5"/>
								<topPen lineWidth="0.5"/>
								<leftPen lineWidth="0.5"/>
								<bottomPen lineWidth="0.5"/>
								<rightPen lineWidth="0.5"/>
							</box>
							<textElement verticalAlignment="Middle">
								<font fontName="宋体" size="12"/>
							</textElement>
							<text><![CDATA[设备自编号]]></text>
						</staticText>
						<staticText>
							<reportElement style="Crosstab Data Text" x="743" y="0" width="100" height="60" uuid="47e43b8f-2e5b-4792-b11f-9abe8ea4b3fd"/>
							<box>
								<pen lineWidth="0.5"/>
								<topPen lineWidth="0.5"/>
								<leftPen lineWidth="0.5"/>
								<bottomPen lineWidth="0.5"/>
								<rightPen lineWidth="0.5"/>
							</box>
							<textElement verticalAlignment="Middle">
								<font fontName="宋体" size="12"/>
							</textElement>
							<text><![CDATA[规格型号]]></text>
						</staticText>
						<staticText>
							<reportElement style="Crosstab Data Text" x="843" y="0" width="100" height="60" uuid="e02a0af1-8d9d-4937-9d2f-a45648276017"/>
							<box>
								<pen lineWidth="0.5"/>
								<topPen lineWidth="0.5"/>
								<leftPen lineWidth="0.5"/>
								<bottomPen lineWidth="0.5"/>
								<rightPen lineWidth="0.5"/>
							</box>
							<textElement verticalAlignment="Middle">
								<font fontName="宋体" size="12"/>
							</textElement>
							<text><![CDATA[安装日期]]></text>
						</staticText>
						<staticText>
							<reportElement style="Crosstab Data Text" x="943" y="0" width="100" height="60" uuid="c1eeedcd-c283-4d36-96b2-8e6ff6082f10"/>
							<box>
								<pen lineWidth="0.5"/>
								<topPen lineWidth="0.5"/>
								<leftPen lineWidth="0.5"/>
								<bottomPen lineWidth="0.5"/>
								<rightPen lineWidth="0.5"/>
							</box>
							<textElement verticalAlignment="Middle">
								<font fontName="宋体" size="12"/>
							</textElement>
							<text><![CDATA[起租日期]]></text>
						</staticText>
						<staticText>
							<reportElement style="Crosstab Data Text" x="1043" y="0" width="100" height="60" uuid="92588591-d6ca-4a02-b12d-a72a97ccd34d"/>
							<box>
								<pen lineWidth="0.5"/>
								<topPen lineWidth="0.5"/>
								<leftPen lineWidth="0.5"/>
								<bottomPen lineWidth="0.5"/>
								<rightPen lineWidth="0.5"/>
							</box>
							<textElement verticalAlignment="Middle">
								<font fontName="宋体" size="12"/>
							</textElement>
							<text><![CDATA[停租日期]]></text>
						</staticText>
						<staticText>
							<reportElement style="Crosstab Data Text" x="1143" y="0" width="100" height="60" uuid="99c48e9f-b497-416a-a69d-9cbfb0e33235"/>
							<box>
								<pen lineWidth="0.5"/>
								<topPen lineWidth="0.5"/>
								<leftPen lineWidth="0.5"/>
								<bottomPen lineWidth="0.5"/>
								<rightPen lineWidth="0.5"/>
							</box>
							<textElement verticalAlignment="Middle">
								<font fontName="宋体" size="12"/>
							</textElement>
							<text><![CDATA[项目经理]]></text>
						</staticText>
					</cellContents>
				</crosstabHeaderCell>
				<rowGroup name="GROUP_COMPANY" width="71" headerPosition="Middle">
					<bucket class="java.lang.String">
						<bucketExpression><![CDATA[$F{GROUP_COMPANY}]]></bucketExpression>
					</bucket>
					<crosstabRowHeader>
						<cellContents backcolor="#F0F8FF" mode="Opaque">
							<box>
								<pen lineWidth="0.5" lineStyle="Solid" lineColor="#000000"/>
							</box>
							<textField>
								<reportElement style="Crosstab Data Text" x="0" y="0" width="71" height="50" uuid="ae262cf0-d296-4746-b611-b52592366e40"/>
								<textElement verticalAlignment="Middle">
									<font fontName="宋体"/>
								</textElement>
								<textFieldExpression><![CDATA[$V{GROUP_COMPANY}.substring(1)]]></textFieldExpression>
							</textField>
						</cellContents>
					</crosstabRowHeader>
					<crosstabTotalRowHeader>
						<cellContents backcolor="#BFE1FF" mode="Opaque">
							<box>
								<pen lineWidth="0.5" lineStyle="Solid" lineColor="#000000"/>
							</box>
							<staticText>
								<reportElement x="0" y="0" width="70" height="25" uuid="9293199b-5b37-4f63-bd37-67f01d917b19"/>
								<textElement textAlignment="Center" verticalAlignment="Middle"/>
								<text><![CDATA[Total GROUP_COMPANY]]></text>
							</staticText>
						</cellContents>
					</crosstabTotalRowHeader>
				</rowGroup>
				<rowGroup name="PA_ENT_NAME" width="177" totalPosition="End" headerPosition="Middle">
					<bucket class="java.lang.String">
						<bucketExpression><![CDATA[$F{PA_ENT_NAME}]]></bucketExpression>
					</bucket>
					<crosstabRowHeader>
						<cellContents>
							<box>
								<pen lineWidth="0.5"/>
								<topPen lineWidth="0.5"/>
								<leftPen lineWidth="0.5"/>
								<bottomPen lineWidth="0.5"/>
								<rightPen lineWidth="0.5"/>
							</box>
							<textField isStretchWithOverflow="true" isBlankWhenNull="true">
								<reportElement style="Crosstab Data Text" stretchType="RelativeToBandHeight" x="0" y="0" width="177" height="25" uuid="6249bf84-c7b9-448d-b673-68a407cef63c"/>
								<box>
									<pen lineWidth="0.0"/>
									<topPen lineWidth="0.0"/>
									<leftPen lineWidth="0.0"/>
									<bottomPen lineWidth="0.0"/>
									<rightPen lineWidth="0.0"/>
								</box>
								<textElement verticalAlignment="Middle">
									<font fontName="宋体"/>
								</textElement>
								<textFieldExpression><![CDATA[$V{PA_ENT_NAME}]]></textFieldExpression>
							</textField>
						</cellContents>
					</crosstabRowHeader>
					<crosstabTotalRowHeader>
						<cellContents backcolor="#ADDDB7" mode="Opaque">
							<box>
								<pen lineWidth="0.5"/>
								<topPen lineWidth="0.5"/>
								<leftPen lineWidth="0.5"/>
								<bottomPen lineWidth="0.5"/>
								<rightPen lineWidth="0.5"/>
							</box>
							<textField>
								<reportElement style="Crosstab Data Text" x="0" y="0" width="1172" height="25" uuid="8ee6723b-0812-4a15-a8ef-b6f54eff94be"/>
								<box>
									<pen lineWidth="0.0"/>
									<topPen lineWidth="0.0"/>
									<leftPen lineWidth="0.0"/>
									<bottomPen lineWidth="0.0"/>
									<rightPen lineWidth="0.0"/>
								</box>
								<textElement verticalAlignment="Middle">
									<font fontName="宋体"/>
								</textElement>
								<textFieldExpression><![CDATA[$V{GROUP_COMPANY}.substring(1)+"合计"]]></textFieldExpression>
							</textField>
						</cellContents>
					</crosstabTotalRowHeader>
				</rowGroup>
				<rowGroup name="PROJECT_NAME" width="195" headerPosition="Middle">
					<bucket class="java.lang.String">
						<bucketExpression><![CDATA[$F{PROJECT_NAME}]]></bucketExpression>
					</bucket>
					<crosstabRowHeader>
						<cellContents>
							<box>
								<pen lineWidth="0.5"/>
								<topPen lineWidth="0.5"/>
								<leftPen lineWidth="0.5"/>
								<bottomPen lineWidth="0.5"/>
								<rightPen lineWidth="0.5"/>
							</box>
							<textField isStretchWithOverflow="true" isBlankWhenNull="true">
								<reportElement style="Crosstab Data Text" stretchType="RelativeToBandHeight" x="0" y="0" width="195" height="25" uuid="fcbd98a6-a2f7-4278-a791-695c064708d6"/>
								<box>
									<pen lineWidth="0.0"/>
									<topPen lineWidth="0.0"/>
									<leftPen lineWidth="0.0"/>
									<bottomPen lineWidth="0.0"/>
									<rightPen lineWidth="0.0"/>
								</box>
								<textElement verticalAlignment="Middle">
									<font fontName="宋体"/>
								</textElement>
								<textFieldExpression><![CDATA[$V{PROJECT_NAME}]]></textFieldExpression>
							</textField>
						</cellContents>
					</crosstabRowHeader>
					<crosstabTotalRowHeader>
						<cellContents/>
					</crosstabTotalRowHeader>
				</rowGroup>
				<rowGroup name="DEP_NAME" width="100" headerPosition="Middle">
					<bucket class="java.lang.String">
						<bucketExpression><![CDATA[$F{DEP_NAME}]]></bucketExpression>
					</bucket>
					<crosstabRowHeader>
						<cellContents>
							<box>
								<pen lineWidth="0.5"/>
								<topPen lineWidth="0.5"/>
								<leftPen lineWidth="0.5"/>
								<bottomPen lineWidth="0.5"/>
								<rightPen lineWidth="0.5"/>
							</box>
							<textField isStretchWithOverflow="true" isBlankWhenNull="true">
								<reportElement style="Crosstab Data Text" stretchType="RelativeToBandHeight" x="0" y="0" width="100" height="25" uuid="ef8bda7e-759e-4a76-8590-6f71e17fb542"/>
								<box>
									<pen lineWidth="0.0"/>
									<topPen lineWidth="0.0"/>
									<leftPen lineWidth="0.0"/>
									<bottomPen lineWidth="0.0"/>
									<rightPen lineWidth="0.0"/>
								</box>
								<textElement verticalAlignment="Middle">
									<font fontName="宋体"/>
								</textElement>
								<textFieldExpression><![CDATA[$V{DEP_NAME}]]></textFieldExpression>
							</textField>
						</cellContents>
					</crosstabRowHeader>
					<crosstabTotalRowHeader>
						<cellContents/>
					</crosstabTotalRowHeader>
				</rowGroup>
				<rowGroup name="CONSTRACT_NO" width="100" headerPosition="Middle">
					<bucket class="java.lang.String">
						<bucketExpression><![CDATA[$F{CONSTRACT_NO}]]></bucketExpression>
					</bucket>
					<crosstabRowHeader>
						<cellContents>
							<box>
								<pen lineWidth="0.5"/>
								<topPen lineWidth="0.5"/>
								<leftPen lineWidth="0.5"/>
								<bottomPen lineWidth="0.5"/>
								<rightPen lineWidth="0.5"/>
							</box>
							<textField isStretchWithOverflow="true" isBlankWhenNull="true">
								<reportElement style="Crosstab Data Text" stretchType="RelativeToBandHeight" x="0" y="0" width="100" height="25" uuid="83e0afcd-19c4-4b89-acee-a38add44d631"/>
								<box>
									<pen lineWidth="0.0"/>
									<topPen lineWidth="0.0"/>
									<leftPen lineWidth="0.0"/>
									<bottomPen lineWidth="0.0"/>
									<rightPen lineWidth="0.0"/>
								</box>
								<textElement verticalAlignment="Middle">
									<font fontName="宋体"/>
								</textElement>
								<textFieldExpression><![CDATA[$V{CONSTRACT_NO}]]></textFieldExpression>
							</textField>
						</cellContents>
					</crosstabRowHeader>
					<crosstabTotalRowHeader>
						<cellContents/>
					</crosstabTotalRowHeader>
				</rowGroup>
				<rowGroup name="EQUIP_SERIAL" width="100" headerPosition="Middle">
					<bucket class="java.lang.String">
						<bucketExpression><![CDATA[$F{EQUIP_SERIAL}]]></bucketExpression>
					</bucket>
					<crosstabRowHeader>
						<cellContents>
							<box>
								<pen lineWidth="0.5"/>
								<topPen lineWidth="0.5"/>
								<leftPen lineWidth="0.5"/>
								<bottomPen lineWidth="0.5"/>
								<rightPen lineWidth="0.5"/>
							</box>
							<textField isStretchWithOverflow="true" isBlankWhenNull="true">
								<reportElement style="Crosstab Data Text" stretchType="RelativeToBandHeight" x="0" y="0" width="100" height="25" uuid="50782e50-9f22-4d68-a814-3124260704d5"/>
								<box>
									<pen lineWidth="0.0"/>
									<topPen lineWidth="0.0"/>
									<leftPen lineWidth="0.0"/>
									<bottomPen lineWidth="0.0"/>
									<rightPen lineWidth="0.0"/>
								</box>
								<textElement verticalAlignment="Middle">
									<font fontName="宋体"/>
								</textElement>
								<textFieldExpression><![CDATA[$V{EQUIP_SERIAL}]]></textFieldExpression>
							</textField>
						</cellContents>
					</crosstabRowHeader>
					<crosstabTotalRowHeader>
						<cellContents/>
					</crosstabTotalRowHeader>
				</rowGroup>
				<rowGroup name="EQUIP_SPECIFIC" width="100" headerPosition="Middle">
					<bucket class="java.lang.String">
						<bucketExpression><![CDATA[$F{EQUIP_SPECIFIC}]]></bucketExpression>
					</bucket>
					<crosstabRowHeader>
						<cellContents>
							<box>
								<pen lineWidth="0.5"/>
								<topPen lineWidth="0.5"/>
								<leftPen lineWidth="0.5"/>
								<bottomPen lineWidth="0.5"/>
								<rightPen lineWidth="0.5"/>
							</box>
							<textField isStretchWithOverflow="true" isBlankWhenNull="true">
								<reportElement style="Crosstab Data Text" stretchType="RelativeToBandHeight" x="0" y="0" width="100" height="25" uuid="6faf3c24-1982-4d3d-83c5-a209f9c36241"/>
								<box>
									<pen lineWidth="0.0"/>
									<topPen lineWidth="0.0"/>
									<leftPen lineWidth="0.0"/>
									<bottomPen lineWidth="0.0"/>
									<rightPen lineWidth="0.0"/>
								</box>
								<textElement verticalAlignment="Middle">
									<font fontName="宋体"/>
								</textElement>
								<textFieldExpression><![CDATA[$V{EQUIP_SPECIFIC}]]></textFieldExpression>
							</textField>
						</cellContents>
					</crosstabRowHeader>
					<crosstabTotalRowHeader>
						<cellContents/>
					</crosstabTotalRowHeader>
				</rowGroup>
				<rowGroup name="STARTIN_DATE" width="100" headerPosition="Middle">
					<bucket class="java.lang.String">
						<bucketExpression><![CDATA[$F{STARTIN_DATE}]]></bucketExpression>
					</bucket>
					<crosstabRowHeader>
						<cellContents>
							<box>
								<pen lineWidth="0.5"/>
								<topPen lineWidth="0.5"/>
								<leftPen lineWidth="0.5"/>
								<bottomPen lineWidth="0.5"/>
								<rightPen lineWidth="0.5"/>
							</box>
							<textField isStretchWithOverflow="true" pattern="d/M/yyyy" isBlankWhenNull="true">
								<reportElement style="Crosstab Data Text" stretchType="RelativeToBandHeight" x="0" y="0" width="100" height="25" uuid="675e569e-fdf1-4be3-bb08-955bc03c4d4b"/>
								<box>
									<pen lineWidth="0.0"/>
									<topPen lineWidth="0.0"/>
									<leftPen lineWidth="0.0"/>
									<bottomPen lineWidth="0.0"/>
									<rightPen lineWidth="0.0"/>
								</box>
								<textElement verticalAlignment="Middle">
									<font fontName="宋体"/>
								</textElement>
								<textFieldExpression><![CDATA[$V{STARTIN_DATE}]]></textFieldExpression>
							</textField>
						</cellContents>
					</crosstabRowHeader>
					<crosstabTotalRowHeader>
						<cellContents/>
					</crosstabTotalRowHeader>
				</rowGroup>
				<rowGroup name="ACTIVATE_DATE" width="100" headerPosition="Middle">
					<bucket class="java.lang.String">
						<bucketExpression><![CDATA[$F{ACTIVATE_DATE}]]></bucketExpression>
					</bucket>
					<crosstabRowHeader>
						<cellContents>
							<box>
								<pen lineWidth="0.5"/>
								<topPen lineWidth="0.5"/>
								<leftPen lineWidth="0.5"/>
								<bottomPen lineWidth="0.5"/>
								<rightPen lineWidth="0.5"/>
							</box>
							<textField isStretchWithOverflow="true" isBlankWhenNull="true">
								<reportElement style="Crosstab Data Text" stretchType="RelativeToBandHeight" x="0" y="0" width="100" height="25" uuid="fd0ecac7-1219-4555-86f1-40a59efdb064"/>
								<box>
									<pen lineWidth="0.0"/>
									<topPen lineWidth="0.0"/>
									<leftPen lineWidth="0.0"/>
									<bottomPen lineWidth="0.0"/>
									<rightPen lineWidth="0.0"/>
								</box>
								<textElement verticalAlignment="Middle">
									<font fontName="宋体"/>
								</textElement>
								<textFieldExpression><![CDATA[$V{ACTIVATE_DATE}]]></textFieldExpression>
							</textField>
						</cellContents>
					</crosstabRowHeader>
					<crosstabTotalRowHeader>
						<cellContents/>
					</crosstabTotalRowHeader>
				</rowGroup>
				<rowGroup name="BLOCKUP_DATE" width="100" headerPosition="Middle">
					<bucket class="java.lang.String">
						<bucketExpression><![CDATA[$F{BLOCKUP_DATE}]]></bucketExpression>
					</bucket>
					<crosstabRowHeader>
						<cellContents>
							<box>
								<pen lineWidth="0.5"/>
								<topPen lineWidth="0.5"/>
								<leftPen lineWidth="0.5"/>
								<bottomPen lineWidth="0.5"/>
								<rightPen lineWidth="0.5"/>
							</box>
							<textField isStretchWithOverflow="true" isBlankWhenNull="true">
								<reportElement style="Crosstab Data Text" stretchType="RelativeToBandHeight" x="0" y="0" width="100" height="25" uuid="1cb33945-e483-4415-a49a-ff9d7d919a07"/>
								<box>
									<pen lineWidth="0.0"/>
									<topPen lineWidth="0.0"/>
									<leftPen lineWidth="0.0"/>
									<bottomPen lineWidth="0.0"/>
									<rightPen lineWidth="0.0"/>
								</box>
								<textElement verticalAlignment="Middle">
									<font fontName="宋体"/>
								</textElement>
								<textFieldExpression><![CDATA[$V{BLOCKUP_DATE}]]></textFieldExpression>
							</textField>
						</cellContents>
					</crosstabRowHeader>
					<crosstabTotalRowHeader>
						<cellContents/>
					</crosstabTotalRowHeader>
				</rowGroup>
				<rowGroup name="PROJECT_MANAGER" width="100" headerPosition="Middle">
					<bucket class="java.lang.String">
						<bucketExpression><![CDATA[$F{PROJECT_MANAGER}]]></bucketExpression>
					</bucket>
					<crosstabRowHeader>
						<cellContents>
							<box>
								<pen lineWidth="0.5"/>
								<topPen lineWidth="0.5"/>
								<leftPen lineWidth="0.5"/>
								<bottomPen lineWidth="0.5"/>
								<rightPen lineWidth="0.5"/>
							</box>
							<textField isStretchWithOverflow="true" isBlankWhenNull="true">
								<reportElement style="Crosstab Data Text" stretchType="RelativeToBandHeight" x="0" y="0" width="100" height="25" uuid="a18e812a-aab2-4f48-837e-e3536f090afa"/>
								<box>
									<pen lineWidth="0.0"/>
									<topPen lineWidth="0.0"/>
									<leftPen lineWidth="0.0"/>
									<bottomPen lineWidth="0.0"/>
									<rightPen lineWidth="0.0"/>
								</box>
								<textElement verticalAlignment="Middle">
									<font fontName="宋体"/>
								</textElement>
								<textFieldExpression><![CDATA[$V{PROJECT_MANAGER}]]></textFieldExpression>
							</textField>
						</cellContents>
					</crosstabRowHeader>
					<crosstabTotalRowHeader>
						<cellContents/>
					</crosstabTotalRowHeader>
				</rowGroup>
				<columnGroup name="START_SETTLE_DATE" height="30" totalPosition="End">
					<bucket class="java.lang.String">
						<bucketExpression><![CDATA[$F{START_SETTLE_DATE}]]></bucketExpression>
					</bucket>
					<crosstabColumnHeader>
						<cellContents backcolor="#F0F8FF" mode="Opaque">
							<box>
								<pen lineWidth="0.5" lineStyle="Solid" lineColor="#000000"/>
							</box>
							<textField>
								<reportElement style="Crosstab Data Text" x="0" y="0" width="136" height="30" uuid="26b4304c-114f-4e26-a8cc-7c186cb7b4bf"/>
								<textElement verticalAlignment="Middle">
									<font fontName="宋体"/>
								</textElement>
								<textFieldExpression><![CDATA[$V{START_SETTLE_DATE}+"产值"]]></textFieldExpression>
							</textField>
						</cellContents>
					</crosstabColumnHeader>
					<crosstabTotalColumnHeader>
						<cellContents backcolor="#9999FF" mode="Opaque">
							<box>
								<pen lineWidth="0.5" lineStyle="Solid" lineColor="#000000"/>
							</box>
							<staticText>
								<reportElement x="0" y="0" width="69" height="60" forecolor="#000000" uuid="95236237-c64e-4fc9-87cf-968c076425f6"/>
								<textElement textAlignment="Center" verticalAlignment="Middle">
									<font fontName="宋体"/>
								</textElement>
								<text><![CDATA[产值]]></text>
							</staticText>
						</cellContents>
					</crosstabTotalColumnHeader>
				</columnGroup>
				<columnGroup name="TYPE" height="30" totalPosition="End">
					<bucket class="java.lang.String">
						<bucketExpression><![CDATA[$F{TYPE}]]></bucketExpression>
					</bucket>
					<crosstabColumnHeader>
						<cellContents backcolor="#F0F8FF" mode="Opaque">
							<box>
								<pen lineWidth="0.5" lineStyle="Solid" lineColor="#000000"/>
							</box>
							<textField>
								<reportElement style="Crosstab Data Text" x="0" y="0" width="67" height="30" uuid="191ead1b-b843-4f9e-86e6-58081c03f027"/>
								<textElement verticalAlignment="Middle">
									<font fontName="宋体"/>
								</textElement>
								<textFieldExpression><![CDATA[$V{TYPE}.substring(1)]]></textFieldExpression>
							</textField>
						</cellContents>
					</crosstabColumnHeader>
					<crosstabTotalColumnHeader>
						<cellContents backcolor="#BFE1FF" mode="Opaque">
							<box>
								<pen lineWidth="0.5" lineStyle="Solid" lineColor="#000000"/>
							</box>
							<staticText>
								<reportElement x="0" y="0" width="69" height="30" uuid="5ecb0f24-91d8-4477-a424-03ef4822ab36"/>
								<textElement textAlignment="Center" verticalAlignment="Middle">
									<font fontName="宋体"/>
								</textElement>
								<text><![CDATA[小计]]></text>
							</staticText>
						</cellContents>
					</crosstabTotalColumnHeader>
				</columnGroup>
				<measure name="SUMMARYMeasure" class="java.math.BigDecimal" calculation="Sum">
					<measureExpression><![CDATA[$F{SUMMARY}]]></measureExpression>
				</measure>
				<crosstabCell width="67" height="25">
					<cellContents>
						<box>
							<pen lineWidth="0.5" lineStyle="Solid" lineColor="#000000"/>
						</box>
						<textField isStretchWithOverflow="true">
							<reportElement style="Crosstab Data Text" x="0" y="0" width="67" height="25" uuid="31f83924-f350-4d9a-8874-78c88e52fc38"/>
							<textElement verticalAlignment="Middle">
								<font fontName="宋体"/>
							</textElement>
							<textFieldExpression><![CDATA[$V{SUMMARYMeasure}]]></textFieldExpression>
						</textField>
					</cellContents>
				</crosstabCell>
				<crosstabCell width="69" height="25" columnTotalGroup="TYPE">
					<cellContents backcolor="#BFE1FF" mode="Opaque">
						<box>
							<pen lineWidth="0.5" lineStyle="Solid" lineColor="#000000"/>
						</box>
						<textField isStretchWithOverflow="true">
							<reportElement style="Crosstab Data Text" x="0" y="0" width="69" height="25" uuid="be1b37b6-3bb0-420d-95cf-679b93b53d6f"/>
							<textElement verticalAlignment="Middle">
								<font fontName="宋体"/>
							</textElement>
							<textFieldExpression><![CDATA[$V{SUMMARYMeasure}]]></textFieldExpression>
						</textField>
					</cellContents>
				</crosstabCell>
				<crosstabCell width="69" height="25" columnTotalGroup="START_SETTLE_DATE">
					<cellContents backcolor="#9999FF" mode="Opaque">
						<box>
							<pen lineWidth="0.5" lineStyle="Solid" lineColor="#000000"/>
						</box>
						<textField isStretchWithOverflow="true">
							<reportElement style="Crosstab Data Text" x="0" y="0" width="69" height="25" forecolor="#000000" uuid="b40a186b-a9f6-4580-8df9-3d53fbb0c26f"/>
							<textElement verticalAlignment="Middle">
								<font fontName="宋体"/>
							</textElement>
							<textFieldExpression><![CDATA[$V{SUMMARYMeasure}]]></textFieldExpression>
						</textField>
					</cellContents>
				</crosstabCell>
				<crosstabCell width="67" rowTotalGroup="PA_ENT_NAME">
					<cellContents backcolor="#ADDDB7" mode="Opaque">
						<box>
							<pen lineWidth="0.5"/>
							<topPen lineWidth="0.5"/>
							<leftPen lineWidth="0.5"/>
							<bottomPen lineWidth="0.5"/>
							<rightPen lineWidth="0.5"/>
						</box>
						<textField>
							<reportElement style="Crosstab Data Text" x="0" y="0" width="67" height="25" uuid="9a0d5e59-f922-48c4-80f3-cf2c33005a1f"/>
							<box>
								<pen lineWidth="0.0"/>
								<topPen lineWidth="0.0"/>
								<leftPen lineWidth="0.0"/>
								<bottomPen lineWidth="0.0"/>
								<rightPen lineWidth="0.0"/>
							</box>
							<textElement verticalAlignment="Middle">
								<font fontName="宋体"/>
							</textElement>
							<textFieldExpression><![CDATA[$V{SUMMARYMeasure}]]></textFieldExpression>
						</textField>
					</cellContents>
				</crosstabCell>
				<crosstabCell width="69" rowTotalGroup="PA_ENT_NAME" columnTotalGroup="TYPE">
					<cellContents backcolor="#ADDDB7" mode="Opaque">
						<box>
							<pen lineWidth="0.5"/>
							<topPen lineWidth="0.5"/>
							<leftPen lineWidth="0.5"/>
							<bottomPen lineWidth="0.5"/>
							<rightPen lineWidth="0.5"/>
						</box>
						<textField>
							<reportElement style="Crosstab Data Text" x="0" y="0" width="69" height="25" uuid="db992298-eb2a-4a63-b463-be7f1eeff16b"/>
							<box>
								<pen lineWidth="0.0"/>
								<topPen lineWidth="0.0"/>
								<leftPen lineWidth="0.0"/>
								<bottomPen lineWidth="0.0"/>
								<rightPen lineWidth="0.0"/>
							</box>
							<textElement verticalAlignment="Middle">
								<font fontName="宋体"/>
							</textElement>
							<textFieldExpression><![CDATA[$V{SUMMARYMeasure}]]></textFieldExpression>
						</textField>
					</cellContents>
				</crosstabCell>
				<crosstabCell width="69" rowTotalGroup="PA_ENT_NAME" columnTotalGroup="START_SETTLE_DATE">
					<cellContents backcolor="#ADDDB7" mode="Opaque">
						<box>
							<pen lineWidth="0.5"/>
							<topPen lineWidth="0.5"/>
							<leftPen lineWidth="0.5"/>
							<bottomPen lineWidth="0.5"/>
							<rightPen lineWidth="0.5"/>
						</box>
						<textField>
							<reportElement style="Crosstab Data Text" x="0" y="0" width="69" height="25" forecolor="#000000" uuid="6de925cd-544f-471b-8883-e56ff3ead035"/>
							<box>
								<pen lineWidth="0.0"/>
								<topPen lineWidth="0.0"/>
								<leftPen lineWidth="0.0"/>
								<bottomPen lineWidth="0.0"/>
								<rightPen lineWidth="0.0"/>
							</box>
							<textElement verticalAlignment="Middle">
								<font fontName="宋体"/>
							</textElement>
							<textFieldExpression><![CDATA[$V{SUMMARYMeasure}]]></textFieldExpression>
						</textField>
					</cellContents>
				</crosstabCell>
			</crosstab>
		</band>
	</summary>
</jasperReport>
