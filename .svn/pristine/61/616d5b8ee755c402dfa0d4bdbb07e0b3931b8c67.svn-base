<?xml version="1.0" encoding="UTF-8"?>
<jasperReport xmlns="http://jasperreports.sourceforge.net/jasperreports" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://jasperreports.sourceforge.net/jasperreports http://jasperreports.sourceforge.net/xsd/jasperreport.xsd" name="Cash_Flow_Statement" language="groovy" pageWidth="756" pageHeight="595" whenNoDataType="AllSectionsNoDetail" columnWidth="716" leftMargin="20" rightMargin="20" topMargin="20" bottomMargin="20" isFloatColumnFooter="true" isIgnorePagination="true" uuid="5b6e3590-6e36-41fb-a18b-96ea05279ca3">
	<property name="ireport.zoom" value="1.2100000000000006"/>
	<property name="ireport.x" value="0"/>
	<property name="ireport.y" value="0"/>
	<style name="detail" forecolor="#000000" backcolor="#FFFFFF" fill="Solid" hAlign="Center" vAlign="Middle" rotation="None" fontSize="12" isBold="false" isItalic="false" isUnderline="false" isStrikeThrough="false" isPdfEmbedded="false">
		<pen lineWidth="0.5"/>
		<conditionalStyle>
			<conditionExpression><![CDATA[new Boolean((($V{PAGE_COUNT} % 2) == 0))]]></conditionExpression>
			<style forecolor="#000000" backcolor="#CCCCCC" fill="Solid" fontSize="12" isBold="false" isItalic="false" isUnderline="false" isStrikeThrough="false"/>
		</conditionalStyle>
	</style>
	<style name="rowspan" forecolor="#0066FF" backcolor="#FFFFFF" fill="Solid" hAlign="Center" vAlign="Middle" rotation="None" fontSize="12" isBold="false" isItalic="false" isUnderline="false" isStrikeThrough="false">
		<pen lineWidth="0.5"/>
		<conditionalStyle>
			<conditionExpression><![CDATA[new Boolean($V{ROWSPAN}.compareTo(BigDecimal.ZERO) == -1)]]></conditionExpression>
			<style mode="Transparent" forecolor="#CC0033" backcolor="#FFFFFF" fill="Solid" hAlign="Center" vAlign="Middle" rotation="None" fontSize="12" isBold="false" isItalic="false" isUnderline="false" isStrikeThrough="false">
				<pen lineWidth="0.5"/>
			</style>
		</conditionalStyle>
	</style>
	<style name="columnHead" forecolor="#333333" backcolor="#AAD7FE" fill="Solid" hAlign="Center" vAlign="Middle" rotation="None" fontName="宋体" fontSize="12" isBold="false" isItalic="false" isUnderline="false" isStrikeThrough="false">
		<pen lineWidth="0.5"/>
		<box topPadding="2" leftPadding="2" bottomPadding="2" rightPadding="2">
			<pen lineWidth="0.5"/>
			<topPen lineWidth="0.5"/>
			<leftPen lineWidth="0.5"/>
			<bottomPen lineWidth="0.5"/>
			<rightPen lineWidth="0.5"/>
		</box>
	</style>
	<style name="title" hAlign="Center" vAlign="Middle" fontName="宋体" fontSize="36" isItalic="false" isUnderline="false" isStrikeThrough="false" pdfFontName="STSong-Light" pdfEncoding="UniGB-UCS2-H"/>
	<style name="pageFooterLable" forecolor="#000000" backcolor="#FFFFFF" fill="Solid" hAlign="Center" vAlign="Middle" fontSize="12" isItalic="false" isUnderline="false" isStrikeThrough="false">
		<pen lineWidth="0.5"/>
	</style>
	<parameter name="INSTALL_DATE_END" class="java.lang.String"/>
	<parameter name="PROJECT_NAME" class="java.lang.String"/>
	<parameter name="EXW_SERIAL" class="java.lang.String"/>
	<parameter name="INSTALL_DATE_BEG" class="java.lang.String"/>
	<queryString>
		<![CDATA[DECLARE @ym_beg CHAR(12)
DECLARE @ym_end CHAR(12)
DECLARE @ymds  CHAR(12)
DECLARE @ymde  CHAR(12)
DECLARE @EXW_SERIAL VARCHAR(64)
DECLARE @PROJECT_NAME VARCHAR(64)

SET @ym_beg = $P{INSTALL_DATE_BEG}
SET @ym_end = $P{INSTALL_DATE_END}
SET @EXW_SERIAL = $P{EXW_SERIAL}
SET @PROJECT_NAME = $P{PROJECT_NAME}

SET @ymds = CONVERT(varchar(8),@ym_beg,112)
SET @ymde = CONVERT(varchar(8),@ym_end,112)

SELECT * FROM(
SELECT ED.PROJECT_NAME PROJECT_NAME,
	   ED.EXW_SERIAL EXW_SERIAL,
	   (CASE WHEN CD.JJSTAUTS = 1 THEN '首次安装' WHEN CD.JJSTAUTS = 2 THEN '顶升加节' END) JJSTAUTS_NAME,
	   (CASE WHEN CD.KNOT_FLAG = 1 THEN CD.COUNTS ELSE 0 END) KNOT_COUNTS,
	   (CASE WHEN CD.WALL_ATTACHE_FLAG = 1 THEN CD.COUNTS ELSE 0 END) WALL_COUNTS,
	   CD.COUNTS*CD.KNOT_METRIC HEIGHT,
	   (CASE WHEN CD.JJSTAUTS = 1 THEN EI.PARTAKE WHEN CD.JJSTAUTS = 2 THEN CD.JJUSERNAME END)INSTALL_USER,
	   CONVERT(varchar(8),(CASE WHEN CD.JJSTAUTS = 1 THEN EI.STARTIN_DATE WHEN CD.JJSTAUTS = 2 THEN CD.START_DATE END),112) INSTALL_DATE
	   FROM T_COMPONENT_DIARY CD
	   LEFT JOIN T_EQUIPMENT_INSTALL EI ON EI.INSTALL_ID = CD.RELATE_ID AND CD.RELATE_MODULE = 'EQUIP_INSTALL'
	   LEFT JOIN T_EQUIPMENT_FLOW EF ON EI.FLOW_ID =EF.FLOW_ID
	   LEFT JOIN T_EQUIPMENT_DIARY ED ON EF.EQUIP_DIARY_ID = ED.EQUIP_DIARY_ID
	   WHERE EI.APPLYFOR_STATE = 3 AND EI.DEL_FLAG = 1) AA
	   WHERE (AA.PROJECT_NAME LIKE '%'+@PROJECT_NAME+ '%' OR @PROJECT_NAME IS NULL OR @PROJECT_NAME = '')
	   AND (AA.EXW_SERIAL LIKE '%'+@EXW_SERIAL+ '%' OR @EXW_SERIAL IS NULL OR @EXW_SERIAL = '')
	   AND (AA.INSTALL_DATE BETWEEN @ymds AND @ymde)]]>
	</queryString>
	<field name="PROJECT_NAME" class="java.lang.String"/>
	<field name="EXW_SERIAL" class="java.lang.String"/>
	<field name="JJSTAUTS_NAME" class="java.lang.String"/>
	<field name="KNOT_COUNTS" class="java.lang.String"/>
	<field name="WALL_COUNTS" class="java.lang.Integer"/>
	<field name="HEIGHT" class="java.lang.Integer"/>
	<field name="INSTALL_USER" class="java.lang.String"/>
	<field name="INSTALL_DATE" class="java.lang.String"/>
	<variable name="INDEX" class="java.lang.Integer" calculation="Count">
		<variableExpression><![CDATA[$V{INDEX}.valueOf(1)]]></variableExpression>
		<initialValueExpression><![CDATA[1]]></initialValueExpression>
	</variable>
	<title>
		<band height="123" splitType="Stretch">
			<staticText>
				<reportElement style="title" x="0" y="0" width="694" height="123" uuid="c8da4909-d587-4acc-96f9-2379010df93c"/>
				<textElement>
					<font fontName="宋体" size="36" isBold="true" pdfFontName="STSong-Light" pdfEncoding="UniGB-UCS2-H" isPdfEmbedded="true"/>
				</textElement>
				<text><![CDATA[安装明细表 ]]></text>
			</staticText>
		</band>
	</title>
	<columnHeader>
		<band height="41" splitType="Stretch">
			<staticText>
				<reportElement style="columnHead" mode="Opaque" x="0" y="0" width="55" height="40" uuid="a26516b8-e88f-4e58-a63a-67a0919963a0"/>
				<textElement>
					<font fontName="宋体" pdfFontName="STSong-Light" pdfEncoding="UniGB-UCS2-H" isPdfEmbedded="true"/>
				</textElement>
				<text><![CDATA[序号]]></text>
			</staticText>
			<staticText>
				<reportElement style="columnHead" mode="Opaque" x="55" y="0" width="139" height="40" uuid="df313e49-4aa6-4f7a-904b-f985184315f3"/>
				<textElement>
					<font fontName="宋体" pdfFontName="STSong-Light" pdfEncoding="UniGB-UCS2-H" isPdfEmbedded="true"/>
				</textElement>
				<text><![CDATA[项目名称]]></text>
			</staticText>
			<staticText>
				<reportElement style="columnHead" mode="Opaque" x="194" y="0" width="80" height="40" uuid="42c94954-067c-4f6b-aa5d-acc14955dcf8"/>
				<textElement>
					<font fontName="宋体" pdfFontName="STSong-Light" pdfEncoding="UniGB-UCS2-H" isPdfEmbedded="true"/>
				</textElement>
				<text><![CDATA[出厂编号]]></text>
			</staticText>
			<staticText>
				<reportElement style="columnHead" mode="Opaque" x="518" y="0" width="98" height="40" uuid="8680df01-2145-4f79-b581-b976a865f70a"/>
				<textElement>
					<font fontName="宋体" pdfFontName="STSong-Light" pdfEncoding="UniGB-UCS2-H" isPdfEmbedded="true"/>
				</textElement>
				<text><![CDATA[人员]]></text>
			</staticText>
			<staticText>
				<reportElement style="columnHead" mode="Opaque" x="616" y="0" width="78" height="40" uuid="7833a891-73e0-431e-84b7-41603444ee66"/>
				<textElement>
					<font fontName="宋体" pdfFontName="STSong-Light" pdfEncoding="UniGB-UCS2-H" isPdfEmbedded="true"/>
				</textElement>
				<text><![CDATA[安装日期]]></text>
			</staticText>
			<staticText>
				<reportElement style="columnHead" mode="Opaque" x="410" y="0" width="55" height="40" uuid="191f7971-06f0-44f8-a849-4d4e80d8d5b8"/>
				<textElement>
					<font fontName="宋体" pdfFontName="STSong-Light" pdfEncoding="UniGB-UCS2-H" isPdfEmbedded="true"/>
				</textElement>
				<text><![CDATA[附墙数]]></text>
			</staticText>
			<staticText>
				<reportElement style="columnHead" mode="Opaque" x="274" y="0" width="80" height="40" uuid="aafd951e-e904-48e8-a478-1a9c7fe875b6"/>
				<textElement>
					<font fontName="宋体" pdfFontName="STSong-Light" pdfEncoding="UniGB-UCS2-H" isPdfEmbedded="true"/>
				</textElement>
				<text><![CDATA[安装类别]]></text>
			</staticText>
			<staticText>
				<reportElement style="columnHead" mode="Opaque" x="354" y="0" width="56" height="40" uuid="90880f68-010f-43b1-91e7-7e99f9699aa8"/>
				<textElement>
					<font fontName="宋体" pdfFontName="STSong-Light" pdfEncoding="UniGB-UCS2-H" isPdfEmbedded="true"/>
				</textElement>
				<text><![CDATA[标准节数]]></text>
			</staticText>
			<staticText>
				<reportElement style="columnHead" mode="Opaque" x="465" y="0" width="53" height="40" uuid="f7886c0d-d209-4326-aab3-d8ad4b7279b6"/>
				<textElement>
					<font fontName="宋体" pdfFontName="STSong-Light" pdfEncoding="UniGB-UCS2-H" isPdfEmbedded="true"/>
				</textElement>
				<text><![CDATA[高度	]]></text>
			</staticText>
		</band>
	</columnHeader>
	<detail>
		<band height="20" splitType="Stretch">
			<textField isStretchWithOverflow="true" isBlankWhenNull="true">
				<reportElement style="detail" stretchType="RelativeToTallestObject" mode="Opaque" x="55" y="0" width="139" height="20" uuid="018f50a6-2768-4793-bced-ceb5aac7418a"/>
				<box>
					<pen lineWidth="0.5"/>
					<topPen lineWidth="0.5"/>
					<leftPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.5"/>
					<rightPen lineWidth="0.5"/>
				</box>
				<textElement>
					<font fontName="宋体" isStrikeThrough="false" pdfFontName="STSong-Light" pdfEncoding="UniGB-UCS2-H" isPdfEmbedded="true"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{PROJECT_NAME}]]></textFieldExpression>
			</textField>
			<textField isStretchWithOverflow="true" isBlankWhenNull="true">
				<reportElement style="detail" stretchType="RelativeToTallestObject" mode="Opaque" x="194" y="0" width="80" height="20" uuid="21ff4351-c0b4-4c78-9e4a-e0af452163a2"/>
				<box>
					<pen lineWidth="0.5"/>
					<topPen lineWidth="0.5"/>
					<leftPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.5"/>
					<rightPen lineWidth="0.5"/>
				</box>
				<textElement>
					<font fontName="宋体" isStrikeThrough="false" pdfFontName="STSong-Light" pdfEncoding="UniGB-UCS2-H" isPdfEmbedded="true"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{EXW_SERIAL}]]></textFieldExpression>
			</textField>
			<textField isStretchWithOverflow="true" isBlankWhenNull="true">
				<reportElement style="detail" stretchType="RelativeToTallestObject" mode="Opaque" x="518" y="0" width="98" height="20" uuid="3357db25-83a4-478d-9b6d-7da1b175243c"/>
				<box>
					<pen lineWidth="0.5"/>
					<topPen lineWidth="0.5"/>
					<leftPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.5"/>
					<rightPen lineWidth="0.5"/>
				</box>
				<textElement>
					<font fontName="宋体" isStrikeThrough="false" pdfFontName="STSong-Light" pdfEncoding="UniGB-UCS2-H" isPdfEmbedded="true"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{INSTALL_USER}]]></textFieldExpression>
			</textField>
			<textField isStretchWithOverflow="true" isBlankWhenNull="true">
				<reportElement style="detail" stretchType="RelativeToTallestObject" mode="Opaque" x="616" y="0" width="78" height="20" uuid="c13ad0fe-10ee-4478-8024-341f3c6e7c9c"/>
				<box>
					<pen lineWidth="0.5"/>
					<topPen lineWidth="0.5"/>
					<leftPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.5"/>
					<rightPen lineWidth="0.5"/>
				</box>
				<textElement>
					<font fontName="宋体" isStrikeThrough="false" pdfFontName="STSong-Light" pdfEncoding="UniGB-UCS2-H" isPdfEmbedded="true"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{INSTALL_DATE}]]></textFieldExpression>
			</textField>
			<textField isStretchWithOverflow="true" isBlankWhenNull="true">
				<reportElement style="detail" stretchType="RelativeToTallestObject" mode="Opaque" x="410" y="0" width="55" height="20" uuid="7989a94b-5b7b-447e-a217-9e5eb45a19ae"/>
				<box>
					<pen lineWidth="0.5"/>
					<topPen lineWidth="0.5"/>
					<leftPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.5"/>
					<rightPen lineWidth="0.5"/>
				</box>
				<textElement>
					<font fontName="宋体" isStrikeThrough="false" pdfFontName="STSong-Light" pdfEncoding="UniGB-UCS2-H" isPdfEmbedded="true"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{WALL_COUNTS}]]></textFieldExpression>
			</textField>
			<textField isStretchWithOverflow="true" isBlankWhenNull="true">
				<reportElement style="detail" stretchType="RelativeToTallestObject" mode="Opaque" x="274" y="0" width="80" height="20" uuid="cdcb8688-6847-4a46-a202-17aed6989881"/>
				<box>
					<pen lineWidth="0.5"/>
					<topPen lineWidth="0.5"/>
					<leftPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.5"/>
					<rightPen lineWidth="0.5"/>
				</box>
				<textElement>
					<font fontName="宋体" isStrikeThrough="false" pdfFontName="STSong-Light" pdfEncoding="UniGB-UCS2-H" isPdfEmbedded="true"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{JJSTAUTS_NAME}]]></textFieldExpression>
			</textField>
			<textField isStretchWithOverflow="true" isBlankWhenNull="true">
				<reportElement style="detail" stretchType="RelativeToTallestObject" mode="Opaque" x="354" y="0" width="56" height="20" uuid="4be1f33b-e2c9-4c76-af7f-6a36401a36c6"/>
				<box>
					<pen lineWidth="0.5"/>
					<topPen lineWidth="0.5"/>
					<leftPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.5"/>
					<rightPen lineWidth="0.5"/>
				</box>
				<textElement>
					<font fontName="宋体" isStrikeThrough="false" pdfFontName="STSong-Light" pdfEncoding="UniGB-UCS2-H" isPdfEmbedded="true"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{KNOT_COUNTS}]]></textFieldExpression>
			</textField>
			<textField isStretchWithOverflow="true" isBlankWhenNull="true">
				<reportElement style="detail" stretchType="RelativeToTallestObject" mode="Opaque" x="465" y="0" width="53" height="20" uuid="dce1ae63-61b2-4b9b-975a-9efc29521954"/>
				<box>
					<pen lineWidth="0.5"/>
					<topPen lineWidth="0.5"/>
					<leftPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.5"/>
					<rightPen lineWidth="0.5"/>
				</box>
				<textElement>
					<font fontName="宋体" isStrikeThrough="false" pdfFontName="STSong-Light" pdfEncoding="UniGB-UCS2-H" isPdfEmbedded="true"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{HEIGHT}]]></textFieldExpression>
			</textField>
			<textField isStretchWithOverflow="true" isBlankWhenNull="true">
				<reportElement style="detail" stretchType="RelativeToTallestObject" mode="Opaque" x="0" y="0" width="55" height="20" uuid="d51dd58e-ec8e-4585-b9da-2bd37d90ed8f"/>
				<box>
					<pen lineWidth="0.5"/>
					<topPen lineWidth="0.5"/>
					<leftPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.5"/>
					<rightPen lineWidth="0.5"/>
				</box>
				<textElement>
					<font fontName="宋体" isStrikeThrough="false" pdfFontName="STSong-Light" pdfEncoding="UniGB-UCS2-H" isPdfEmbedded="true"/>
				</textElement>
				<textFieldExpression><![CDATA[$V{INDEX}]]></textFieldExpression>
			</textField>
		</band>
	</detail>
	<lastPageFooter>
		<band/>
	</lastPageFooter>
</jasperReport>
