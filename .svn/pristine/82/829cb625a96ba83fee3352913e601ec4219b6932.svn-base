package com.knight.emms.terminal.support.utils;

import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.sql.SQLException;
import java.util.ArrayList;
import java.util.List;
import java.util.Map;

import org.apache.log4j.Logger;

import com.knight.emms.terminal.support.beanutils.UcAccount;

public class UcAccountUtil extends SyncBase {
	private static final Logger log = Logger.getLogger(UcAccount.class);
	
	
	public void insertToMySql(List<Map<String, Object>> ucAccountList) {
		if (Globel.mysqlDb != null) {
			// 插入数据库
			
			String sSQL = "UPDATE `emms_beta`.`UC_ACCOUNT` SET   `PASSWORD`=?, `ACCOUNT_TYPE`=?,  `EXTERNAL_NAME`=? WHERE (`ACCOUNT_NAME`=?);";

//			String sSQL = "INSERT INTO `emms_beta`.`UC_ACCOUNT` ( `ACCOUNT_NAME`, `PASSWORD`, `ACCOUNT_TYPE`,  `EXTERNAL_NAME`, `EXTERNAL_ADDRESS`)" +
//					" VALUES (?,?,?,?,?)";
			log.info(sSQL);
			PreparedStatement pStmt = Globel.mysqlDb.GetPrepareStatement(sSQL);
			
			try {
				for (int i=0;i< ucAccountList.size();i++) {		
					pStmt.setString(1, (String) ucAccountList.get(i).get("PASSWORD"));	       
				 	pStmt.setLong(2, 3);
				 	pStmt.setString(3, (String) ucAccountList.get(i).get("USERNAME")); 	 
					pStmt.setString(4,(String) ucAccountList.get(i).get("MOBILE"));  
					pStmt.executeUpdate();
					log.info("密码更新成功!");
				}
			} catch (Exception e) {
				Globel.mysqlDb = null;
				e.printStackTrace();
				log.info("密码更新失败!");
			} finally {
				try {
					pStmt.close();
				} catch (SQLException e) {
					Globel.mysqlDb = null;
					log.info("密码更新失败!");
					e.printStackTrace();
				}
			}
		}
	}
}
