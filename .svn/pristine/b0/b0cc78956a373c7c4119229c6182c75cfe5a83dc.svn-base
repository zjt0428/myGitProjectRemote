-- =============================================-- Author: <ChengXianYu>-- Create date: <2013-08-11>-- Description: <合并合同设备备案编号>-- =============================================IF EXISTS (SELECT *             FROM DBO.SYSOBJECTS            WHERE ID = OBJECT_ID(N'[DBO].[F_MERGE_CONTRACT_EQUIP]') 			  AND XTYPE = 'FN')  DROP FUNCTION [DBO].[F_MERGE_CONTRACT_EQUIP]GOCREATE FUNCTION [DBO].[F_MERGE_CONTRACT_EQUIP]               (@CONTRACT_ID BIGINT)RETURNS VARCHAR(8000)AS  BEGIN    DECLARE @RECORD_ID VARCHAR(8000)    SET @RECORD_ID = ''    SELECT @RECORD_ID = @RECORD_ID + ';' + RECORD_ID      FROM T_CONTRACT_EQUIP     WHERE CONTRACT_ID = @CONTRACT_ID    RETURN STUFF(@RECORD_ID, 1, 1, '')  ENDGO-- =============================================-- Author: <ChengXianYu>-- Create date: <2013-10-31>-- Description: <合并调度零配件名称>-- =============================================IF EXISTS (SELECT *             FROM DBO.SYSOBJECTS            WHERE ID = OBJECT_ID(N'[DBO].[F_MERGE_DISPATCH_COMPON]')              AND XTYPE = 'FN')  DROP FUNCTION [DBO].[F_MERGE_DISPATCH_COMPON]GOCREATE FUNCTION [DBO].[F_MERGE_DISPATCH_COMPON]               (@DISPATCH_ID BIGINT)RETURNS VARCHAR(8000)AS  BEGIN    DECLARE @COMPON_GENERIC_NAME VARCHAR(8000)    SET @COMPON_GENERIC_NAME = ''    SELECT @COMPON_GENERIC_NAME = @COMPON_GENERIC_NAME + ';' + CG.VALUE      FROM T_DISPATCH_COMPON DC, T_COMPONENT C LEFT JOIN BM_COMPONENT_GENERIC CG ON CG.CODE = C.COMPON_GENERIC     WHERE C.COMPON_ID = DC.COMPON_ID       AND DC.DISPATCH_ID = @DISPATCH_ID    RETURN STUFF(@COMPON_GENERIC_NAME, 1, 1, '')  ENDGO-- =============================================-- Author: <ChengXianYu>-- Create date: <2013-10-31>-- Description: <合并安拆人员名称>-- =============================================IF EXISTS (SELECT *             FROM DBO.SYSOBJECTS            WHERE ID = OBJECT_ID(N'[DBO].[F_MERGE_DISMANTLE_PRACTI]')              AND XTYPE = 'FN')  DROP FUNCTION [DBO].[F_MERGE_DISMANTLE_PRACTI]GOCREATE FUNCTION [DBO].[F_MERGE_DISMANTLE_PRACTI]               (@RELATE_ID BIGINT, @RELATE_MODULE VARCHAR(32))RETURNS VARCHAR(8000)AS  BEGIN    DECLARE @PRACTI_NAME VARCHAR(8000)    SET @PRACTI_NAME = ''    SELECT @PRACTI_NAME = @PRACTI_NAME + ';' + PRACTI_NAME      FROM T_PRACTI_DIARY PD     WHERE PD.RELATE_ID = @RELATE_ID	   AND PD.RELATE_MODULE = @RELATE_MODULE    RETURN STUFF(@PRACTI_NAME, 1, 1, '')  ENDGO-- =============================================-- Author: <liulx>-- Create date: <2019-02-19 >-- Description: <每条合同查询出其对应的所有设备的型号>-- =============================================CREATE FUNCTION [DBO].[JOIN_EQUIPSPECIFICNAME]                     (@CONTRACTID BIGINT)RETURNS VARCHAR(100)ASBEGIN    DECLARE @RET VARCHAR(800)    SET @RET = ''    SELECT @RET = @RET + ',' + P.EQUIP_SPECIFIC_NAME FROM T_CONTRACT_EQUIP_BRIEF P    WHERE  P.CONTRACT_ID=@CONTRACTID    SET @RET = STUFF(@RET, 1, 1, '')    RETURN @RET END