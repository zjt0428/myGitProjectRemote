<?xml version="1.0" encoding="UTF-8"?>
<jasperReport xmlns="http://jasperreports.sourceforge.net/jasperreports" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://jasperreports.sourceforge.net/jasperreports http://jasperreports.sourceforge.net/xsd/jasperreport.xsd" name="Equipment_Rate" language="groovy" pageWidth="595" pageHeight="842" whenNoDataType="AllSectionsNoDetail" columnWidth="555" leftMargin="20" rightMargin="20" topMargin="20" bottomMargin="20" isFloatColumnFooter="true" uuid="5b6e3590-6e36-41fb-a18b-96ea05279ca3">
	<property name="ireport.zoom" value="1.0"/>
	<property name="ireport.x" value="0"/>
	<property name="ireport.y" value="0"/>
	<style name="detail" forecolor="#000000" backcolor="#FFFFFF" fill="Solid" hAlign="Center" vAlign="Middle" rotation="None" fontSize="12" isBold="false" isItalic="false" isUnderline="false" isStrikeThrough="false" isPdfEmbedded="false">
		<pen lineWidth="0.5"/>
		<conditionalStyle>
			<conditionExpression><![CDATA[new Boolean((($V{PAGE_COUNT} % 2) == 0))]]></conditionExpression>
			<style forecolor="#000000" backcolor="#CCCCCC" fill="Solid" fontSize="12" isBold="false" isItalic="false" isUnderline="false" isStrikeThrough="false"/>
		</conditionalStyle>
	</style>
	<style name="rowspan" forecolor="#0066FF" backcolor="#FFFFFF" fill="Solid" hAlign="Center" vAlign="Middle" rotation="None" fontSize="12" isBold="false" isItalic="false" isUnderline="false" isStrikeThrough="false">
		<pen lineWidth="0.5"/>
		<conditionalStyle>
			<conditionExpression><![CDATA[new Boolean($V{ROWSPAN}.compareTo(BigDecimal.ZERO) == -1)]]></conditionExpression>
			<style mode="Transparent" forecolor="#CC0033" backcolor="#FFFFFF" fill="Solid" hAlign="Center" vAlign="Middle" rotation="None" fontSize="12" isBold="false" isItalic="false" isUnderline="false" isStrikeThrough="false">
				<pen lineWidth="0.5"/>
			</style>
		</conditionalStyle>
	</style>
	<style name="columnHead" forecolor="#333333" backcolor="#AAD7FE" fill="Solid" hAlign="Center" vAlign="Middle" rotation="None" fontName="宋体" fontSize="12" isBold="false" isItalic="false" isUnderline="false" isStrikeThrough="false">
		<pen lineWidth="0.5"/>
		<box topPadding="2" leftPadding="2" bottomPadding="2" rightPadding="2">
			<pen lineWidth="0.5"/>
			<topPen lineWidth="0.5"/>
			<leftPen lineWidth="0.5"/>
			<bottomPen lineWidth="0.5"/>
			<rightPen lineWidth="0.5"/>
		</box>
	</style>
	<style name="pageFooterLable" forecolor="#000000" backcolor="#FFFFFF" fill="Solid" hAlign="Center" vAlign="Middle" fontSize="12" isItalic="false" isUnderline="false" isStrikeThrough="false">
		<pen lineWidth="0.5"/>
	</style>
	<style name="pageFooter" mode="Transparent" forecolor="#000000" backcolor="#FFFFFF" fill="Solid" hAlign="Center" vAlign="Middle" fontSize="12" isItalic="false" isUnderline="false" isStrikeThrough="false">
		<pen lineWidth="0.5"/>
	</style>
	<parameter name="RECORD_ID" class="java.lang.String">
		<defaultValueExpression><![CDATA[]]></defaultValueExpression>
	</parameter>
	<parameter name="DURABLE_YEARS" class="java.lang.String">
		<defaultValueExpression><![CDATA[]]></defaultValueExpression>
	</parameter>
	<parameter name="EQUIP_SPECIFIC_NAME" class="java.lang.String"/>
	<parameter name="EQUIP_GENERIC" class="java.lang.String">
		<defaultValueExpression><![CDATA[]]></defaultValueExpression>
	</parameter>
	<parameter name="EQUIP_CATEGORY" class="java.lang.String">
		<defaultValueExpression><![CDATA[]]></defaultValueExpression>
	</parameter>
	<queryString>
		<![CDATA[DECLARE @RECORD_ID VARCHAR(64)
DECLARE @EQUIP_GENERIC VARCHAR(64)
DECLARE @EQUIP_CATEGORY VARCHAR(64)
DECLARE @EQUIP_SPECIFIC_NAME VARCHAR(64)
DECLARE @DURABLE_YEARS VARCHAR(16)
SET @RECORD_ID = $P{RECORD_ID}
SET @EQUIP_GENERIC = $P{EQUIP_GENERIC}
SET @EQUIP_CATEGORY = $P{EQUIP_CATEGORY}
SET @EQUIP_SPECIFIC_NAME = $P{EQUIP_SPECIFIC_NAME}
SET @DURABLE_YEARS = $P{DURABLE_YEARS}
SELECT E.RECORD_ID,
       EC.VALUE EQUIP_SPECIFIC_NAME,
       E.EXW_DATE,
       E.TOTAL_RATE,
       E.ASSET_VALUE,
       E.PRESENT_VALUE,
       DATEDIFF(YEAR, E.EXW_DATE, GETDATE()) DURABLE_YEARS
  FROM T_EQUIPMENT E, BM_EQUIP_SPECIFIC EC
 WHERE E.DEL_FLAG = '1' AND EC.CODE = E.EQUIP_SPECIFIC
 AND E.RECORD_ID LIKE CASE WHEN @RECORD_ID IS NULL THEN '%%' ELSE '%' + @RECORD_ID + '%' END
 AND EC.VALUE LIKE CASE WHEN @EQUIP_SPECIFIC_NAME IS NULL THEN '%%' ELSE '%' + @EQUIP_SPECIFIC_NAME + '%' END
 AND 1 = CASE WHEN @DURABLE_YEARS IS NULL THEN 1 WHEN DATEDIFF(YEAR, E.EXW_DATE, GETDATE()) = @DURABLE_YEARS THEN 1 ELSE 0 END
 AND E.EQUIP_GENERIC = CASE WHEN @EQUIP_GENERIC IS NULL THEN E.EQUIP_GENERIC ELSE @EQUIP_GENERIC END
 AND E.EQUIP_CATEGORY = CASE WHEN @EQUIP_CATEGORY IS NULL THEN E.EQUIP_CATEGORY ELSE @EQUIP_CATEGORY END]]>
	</queryString>
	<field name="RECORD_ID" class="java.lang.String"/>
	<field name="EQUIP_SPECIFIC_NAME" class="java.lang.String"/>
	<field name="EXW_DATE" class="java.lang.String"/>
	<field name="TOTAL_RATE" class="java.math.BigDecimal"/>
	<field name="ASSET_VALUE" class="java.math.BigDecimal"/>
	<field name="PRESENT_VALUE" class="java.math.BigDecimal"/>
	<field name="DURABLE_YEARS" class="java.lang.Integer"/>
	<variable name="INDEX" class="java.lang.Integer" calculation="Count">
		<variableExpression><![CDATA[$V{INDEX}.valueOf( 1 )]]></variableExpression>
		<initialValueExpression><![CDATA[1]]></initialValueExpression>
	</variable>
	<variable name="REPORT_PRESENT" class="java.math.BigDecimal" calculation="Sum">
		<variableExpression><![CDATA[$F{PRESENT_VALUE}]]></variableExpression>
	</variable>
	<variable name="REPORT_ASSET" class="java.math.BigDecimal" calculation="Sum">
		<variableExpression><![CDATA[$F{ASSET_VALUE}]]></variableExpression>
	</variable>
	<title>
		<band height="62" splitType="Stretch">
			<staticText>
				<reportElement x="0" y="0" width="555" height="62" uuid="ece715d0-9e96-4b1d-b40d-a738ebf5e2d4"/>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font fontName="宋体" size="24" isBold="true" pdfFontName="STSong-Light" pdfEncoding="UniGB-UCS2-H" isPdfEmbedded="true"/>
				</textElement>
				<text><![CDATA[设备折旧统计表]]></text>
			</staticText>
		</band>
	</title>
	<columnHeader>
		<band height="20" splitType="Stretch">
			<staticText>
				<reportElement style="columnHead" mode="Opaque" x="35" y="0" width="110" height="20" uuid="a26516b8-e88f-4e58-a63a-67a0919963a0"/>
				<textElement>
					<font fontName="宋体" pdfFontName="STSong-Light" pdfEncoding="UniGB-UCS2-H" isPdfEmbedded="true"/>
				</textElement>
				<text><![CDATA[备案编号]]></text>
			</staticText>
			<staticText>
				<reportElement style="columnHead" mode="Opaque" x="145" y="0" width="90" height="20" uuid="f67e4629-a71b-4b0b-866b-b00ab974fcad"/>
				<textElement>
					<font fontName="宋体" pdfFontName="STSong-Light" pdfEncoding="UniGB-UCS2-H" isPdfEmbedded="true"/>
				</textElement>
				<text><![CDATA[规格型号]]></text>
			</staticText>
			<staticText>
				<reportElement style="columnHead" mode="Opaque" x="295" y="0" width="80" height="20" uuid="9c59725d-0850-48d5-bb34-e57618dda40c"/>
				<textElement>
					<font fontName="宋体" pdfFontName="STSong-Light" pdfEncoding="UniGB-UCS2-H" isPdfEmbedded="true"/>
				</textElement>
				<text><![CDATA[现值]]></text>
			</staticText>
			<staticText>
				<reportElement style="columnHead" mode="Opaque" x="375" y="0" width="90" height="20" uuid="f4d0a95a-f848-4985-90bc-1c0235c07056"/>
				<textElement>
					<font fontName="宋体" pdfFontName="STSong-Light" pdfEncoding="UniGB-UCS2-H" isPdfEmbedded="true"/>
				</textElement>
				<text><![CDATA[原值]]></text>
			</staticText>
			<staticText>
				<reportElement style="columnHead" mode="Opaque" x="465" y="0" width="90" height="20" uuid="3be7d3a2-90bb-410f-9900-9efe54353376"/>
				<textElement>
					<font fontName="宋体" pdfFontName="STSong-Light" pdfEncoding="UniGB-UCS2-H" isPdfEmbedded="true"/>
				</textElement>
				<text><![CDATA[已使用年限(年)]]></text>
			</staticText>
			<staticText>
				<reportElement style="columnHead" mode="Opaque" x="235" y="0" width="60" height="20" uuid="93a6baa8-17b8-4615-af5a-ff16af98184d"/>
				<textElement>
					<font fontName="宋体" pdfFontName="STSong-Light" pdfEncoding="UniGB-UCS2-H" isPdfEmbedded="true"/>
				</textElement>
				<text><![CDATA[折旧率]]></text>
			</staticText>
			<staticText>
				<reportElement style="columnHead" mode="Opaque" x="0" y="0" width="35" height="20" uuid="4552995c-60c4-49f7-9a3b-8b7700464eb1"/>
				<textElement>
					<font fontName="宋体" pdfFontName="STSong-Light" pdfEncoding="UniGB-UCS2-H" isPdfEmbedded="true"/>
				</textElement>
				<text><![CDATA[序号]]></text>
			</staticText>
		</band>
	</columnHeader>
	<detail>
		<band height="20" splitType="Stretch">
			<textField>
				<reportElement style="detail" mode="Opaque" x="35" y="0" width="110" height="20" uuid="bcc1c28b-59bb-4a92-8c2b-727eae80af13"/>
				<box>
					<pen lineWidth="0.5"/>
					<topPen lineWidth="0.5"/>
					<leftPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.5"/>
					<rightPen lineWidth="0.5"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font fontName="宋体" size="12" pdfFontName="STSong-Light" pdfEncoding="UniGB-UCS2-H" isPdfEmbedded="true"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{RECORD_ID}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement style="detail" mode="Opaque" x="235" y="0" width="60" height="20" uuid="12c47648-71d9-4369-9073-ed0768068d86"/>
				<box>
					<pen lineWidth="0.5"/>
					<topPen lineWidth="0.5"/>
					<leftPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.5"/>
					<rightPen lineWidth="0.5"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font fontName="宋体" size="12" pdfFontName="STSong-Light" pdfEncoding="UniGB-UCS2-H" isPdfEmbedded="true"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{TOTAL_RATE}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement style="detail" mode="Opaque" x="295" y="0" width="80" height="20" uuid="60fa0df5-bdf0-4656-9ee2-fe1d166c2510"/>
				<box>
					<pen lineWidth="0.5"/>
					<topPen lineWidth="0.5"/>
					<leftPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.5"/>
					<rightPen lineWidth="0.5"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font fontName="宋体" size="12" pdfFontName="STSong-Light" pdfEncoding="UniGB-UCS2-H" isPdfEmbedded="true"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{PRESENT_VALUE}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement style="detail" mode="Opaque" x="375" y="0" width="90" height="20" uuid="d424f6be-62fd-4817-8a7c-9e66d2b758ec"/>
				<box>
					<pen lineWidth="0.5"/>
					<topPen lineWidth="0.5"/>
					<leftPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.5"/>
					<rightPen lineWidth="0.5"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font fontName="宋体" size="12" pdfFontName="STSong-Light" pdfEncoding="UniGB-UCS2-H" isPdfEmbedded="true"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{ASSET_VALUE}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement style="detail" mode="Opaque" x="465" y="0" width="90" height="20" uuid="e0fa7fee-4bf0-477e-b5f2-df42522dc132"/>
				<box>
					<pen lineWidth="0.5"/>
					<topPen lineWidth="0.5"/>
					<leftPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.5"/>
					<rightPen lineWidth="0.5"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font fontName="宋体" size="12" pdfFontName="STSong-Light" pdfEncoding="UniGB-UCS2-H" isPdfEmbedded="true"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{DURABLE_YEARS}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement style="detail" mode="Opaque" x="145" y="0" width="90" height="20" uuid="ac5f27d4-5533-4abc-aaf5-8ccbb81298d0"/>
				<box>
					<pen lineWidth="0.5"/>
					<topPen lineWidth="0.5"/>
					<leftPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.5"/>
					<rightPen lineWidth="0.5"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font fontName="宋体" size="12" pdfFontName="STSong-Light" pdfEncoding="UniGB-UCS2-H" isPdfEmbedded="true"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{EQUIP_SPECIFIC_NAME}]]></textFieldExpression>
			</textField>
			<textField isStretchWithOverflow="true">
				<reportElement style="detail" stretchType="RelativeToTallestObject" mode="Opaque" x="0" y="0" width="35" height="20" uuid="c5845717-38c7-404d-849f-e39d8d67194b"/>
				<box>
					<pen lineWidth="0.5"/>
					<topPen lineWidth="0.5"/>
					<leftPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.5"/>
					<rightPen lineWidth="0.5"/>
				</box>
				<textElement>
					<font fontName="宋体" isStrikeThrough="false" pdfFontName="STSong-Light" pdfEncoding="UniGB-UCS2-H" isPdfEmbedded="true"/>
				</textElement>
				<textFieldExpression><![CDATA[$V{INDEX}]]></textFieldExpression>
			</textField>
		</band>
	</detail>
	<pageFooter>
		<band height="30">
			<staticText>
				<reportElement x="7" y="6" width="55" height="20" uuid="d924e7ac-9260-4413-8af9-ff8d4ac27eb6"/>
				<textElement textAlignment="Center">
					<font fontName="宋体" pdfFontName="STSong-Light" pdfEncoding="UniGB-UCS2-H" isPdfEmbedded="true"/>
				</textElement>
				<text><![CDATA[记录数：]]></text>
			</staticText>
			<textField>
				<reportElement x="62" y="6" width="20" height="20" uuid="dbbd9539-772a-4dfc-8200-926ebdfe180b"/>
				<textElement textAlignment="Center">
					<font fontName="宋体" pdfFontName="STSong-Light" pdfEncoding="UniGB-UCS2-H" isPdfEmbedded="true"/>
				</textElement>
				<textFieldExpression><![CDATA[$V{PAGE_COUNT}]]></textFieldExpression>
			</textField>
			<staticText>
				<reportElement x="82" y="6" width="10" height="20" uuid="fd7a6051-85ae-4ad8-8a15-5b59442a9898"/>
				<textElement textAlignment="Center">
					<font fontName="宋体" pdfFontName="STSong-Light" pdfEncoding="UniGB-UCS2-H" isPdfEmbedded="true"/>
				</textElement>
				<text><![CDATA[/]]></text>
			</staticText>
			<textField evaluationTime="Report">
				<reportElement x="92" y="6" width="20" height="20" uuid="2264d20d-bc1f-4088-bb44-23594bba4ab6"/>
				<textElement textAlignment="Center">
					<font fontName="宋体" pdfFontName="STSong-Light" pdfEncoding="UniGB-UCS2-H" isPdfEmbedded="true"/>
				</textElement>
				<textFieldExpression><![CDATA[$V{REPORT_COUNT}]]></textFieldExpression>
			</textField>
			<staticText>
				<reportElement x="449" y="6" width="50" height="20" uuid="e2296611-459f-46d2-bd2c-9484eb6f63d1"/>
				<textElement textAlignment="Center">
					<font fontName="宋体" pdfFontName="STSong-Light" pdfEncoding="UniGB-UCS2-H" isPdfEmbedded="true"/>
				</textElement>
				<text><![CDATA[当前页：]]></text>
			</staticText>
			<textField>
				<reportElement x="499" y="6" width="20" height="20" uuid="2e0fff24-3e86-4a5d-b029-e901ced9d1e9"/>
				<textElement textAlignment="Center">
					<font fontName="宋体" pdfFontName="STSong-Light" pdfEncoding="UniGB-UCS2-H" isPdfEmbedded="true"/>
				</textElement>
				<textFieldExpression><![CDATA[$V{PAGE_NUMBER}]]></textFieldExpression>
			</textField>
			<staticText>
				<reportElement x="519" y="6" width="10" height="20" uuid="e5c7a9bc-4fb0-4fba-b087-1b7191c8d54f"/>
				<textElement textAlignment="Center">
					<font fontName="宋体" pdfFontName="STSong-Light" pdfEncoding="UniGB-UCS2-H" isPdfEmbedded="true"/>
				</textElement>
				<text><![CDATA[/]]></text>
			</staticText>
			<textField evaluationTime="Report">
				<reportElement x="529" y="6" width="20" height="20" uuid="30afa7a7-b915-482c-8cff-554d299cbb84"/>
				<textElement textAlignment="Center">
					<font fontName="宋体" pdfFontName="STSong-Light" pdfEncoding="UniGB-UCS2-H" isPdfEmbedded="true"/>
				</textElement>
				<textFieldExpression><![CDATA[$V{PAGE_NUMBER}]]></textFieldExpression>
			</textField>
		</band>
	</pageFooter>
	<lastPageFooter>
		<band height="24">
			<staticText>
				<reportElement style="pageFooterLable" mode="Opaque" x="0" y="0" width="295" height="24" uuid="4085108a-7048-47e5-b7ee-d41a184ec88b"/>
				<box>
					<pen lineWidth="0.5"/>
					<topPen lineWidth="0.5"/>
					<leftPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.5"/>
					<rightPen lineWidth="0.5"/>
				</box>
				<textElement>
					<font fontName="宋体" pdfFontName="STSong-Light" pdfEncoding="UniGB-UCS2-H" isPdfEmbedded="true"/>
				</textElement>
				<text><![CDATA[全部合计]]></text>
			</staticText>
			<textField isBlankWhenNull="true">
				<reportElement style="pageFooter" x="295" y="0" width="80" height="24" uuid="92a75a3d-8afd-4ab7-b46b-4c2e71739e80"/>
				<box>
					<pen lineWidth="0.5"/>
					<topPen lineWidth="0.5"/>
					<leftPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.5"/>
					<rightPen lineWidth="0.5"/>
				</box>
				<textElement>
					<font fontName="宋体" pdfFontName="STSong-Light" pdfEncoding="UniGB-UCS2-H" isPdfEmbedded="true"/>
				</textElement>
				<textFieldExpression><![CDATA[$V{REPORT_PRESENT}]]></textFieldExpression>
			</textField>
			<textField isBlankWhenNull="true">
				<reportElement style="pageFooter" x="375" y="0" width="90" height="24" uuid="6d958698-0ab3-4382-a475-b766dbe479ac"/>
				<box>
					<pen lineWidth="0.5"/>
					<topPen lineWidth="0.5"/>
					<leftPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.5"/>
					<rightPen lineWidth="0.5"/>
				</box>
				<textElement>
					<font fontName="宋体" pdfFontName="STSong-Light" pdfEncoding="UniGB-UCS2-H" isPdfEmbedded="true"/>
				</textElement>
				<textFieldExpression><![CDATA[$V{REPORT_ASSET}]]></textFieldExpression>
			</textField>
			<staticText>
				<reportElement style="pageFooterLable" mode="Opaque" x="465" y="0" width="90" height="24" uuid="6e62e40a-ea24-470e-8238-3f714bac0d39"/>
				<box>
					<pen lineWidth="0.5"/>
					<topPen lineWidth="0.5"/>
					<leftPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.5"/>
					<rightPen lineWidth="0.5"/>
				</box>
				<textElement>
					<font fontName="宋体" pdfFontName="STSong-Light" pdfEncoding="UniGB-UCS2-H" isPdfEmbedded="true"/>
				</textElement>
				<text><![CDATA[]]></text>
			</staticText>
		</band>
	</lastPageFooter>
</jasperReport>
